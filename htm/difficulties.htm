{% extends 'base.htm' %}
{% block title %}Difficulties{% endblock %}
{% block content %}
<h1 class="text-3xl text-black pb-6">Difficulty Presets</h1>
<div class="flex flex-wrap">
  <div class="w-full lg:w-1/1 my-6 pr-0 lg:pr-2">
    <p class="text-xl pb-6 flex items-center"></p>
    <div class="bg-white">
      <nav class="flex flex-col sm:flex-row">
        {% for d in data['list'] %}
        <a href="{{ url_for('difficulty', id=d['id']) }}"
          class="py-4 px-6 block hover:text-red-500 focus:outline-none text-gray-500 border-b-2 font-medium {% if d['id'] == data['id'] %} text-red-500 border-red-500 {% endif %}">
          <i class="fas fa-edit mr-3"></i>{{ d['name'] }}
        </a>
        {% endfor %}

        <form x-data="{ showModal: false, email: '' }" method="POST">
          <a href="#" @click="showModal = true"
            class="py-4 px-6 block hover:text-red-500 focus:outline-none font-medium">
            <i class="fas fa-plus mr-3"></i> Add new Difficulty
          </a>
          <!-- Background overlay -->
          <div x-show="showModal" class="fixed inset-0 transition-opacity" aria-hidden="true"
            @click="showModal = false">
            <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
          </div>
          <!-- Modal -->
          <div x-show="showModal" x-transition:enter="transition ease-out duration-300 transform"
            x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
            x-transition:leave="transition ease-in duration-200 transform"
            x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
            x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
            class="fixed z-10 inset-0 overflow-y-auto" x-cloak>
            <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
              <!-- Modal panel -->
              <div
                class="w-full inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"
                role="dialog" aria-modal="true" aria-labelledby="modal-headline">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                  <!-- Modal content -->
                  <div class="sm:flex sm:items-start">
                    <div class="w-full mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                      <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-headline">
                        Add a new Difficulty
                      </h3>
                      <div class="mt-2">
                        <p class="text-sm text-gray-500">
                          Enter the name of the difficulty
                        </p>
                        <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="difficulty_name"
                          name="difficulty_name" type="text" required="" placeholder="Difficulty Name"
                          aria-label="Difficulty Name" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex">
                  <button class="px-4 py-1 text-white font-light tracking-wider bg-gray-900 rounded-l-md" type="submit">
                    Save
                  </button>
                  <button @click="showModal = false"
                    class="px-4 py-1 text-white font-light tracking-wider bg-red-900 rounded-r-md" type="button">
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          </div>
        </form>
      </nav>

      {% if data['form'] is defined %}
      <script>
        function dynamic_track() {
          return {
            open: {{ 'true' if data.form['dynamic_track'] == 1 else 'false' }},
            dynamic_track_preset: "{{data.form['dynamic_track_preset']}}",
            session_start: "{{data.form['session_start']}}",
            randomness: "{{data.form['randomness']}}",
            session_transfer: "{{data.form['session_transfer']}}",
            lap_gain: "{{data.form['lap_gain']}}",

            set_open: function(val) {
              this.open = val;
              if (!val) {
                this.dynamic_track_preset = '';
                this.session_start = '';
                this.randomness = '';
                this.session_transfer = '';
                this.lap_gain = '';
              }
            },

            preset_changed: function() {
              if (this.dynamic_track_preset == 1) {
                this.session_start = 86;
                this.randomness = 1;
                this.session_transfer = 50;
                this.lap_gain = 30;
              } else if (this.dynamic_track_preset == 2) {
                this.session_start = 89;
                this.randomness = 3;
                this.session_transfer = 80;
                this.lap_gain = 50;
              } else if (this.dynamic_track_preset == 3) {
                this.session_start = 96;
                this.randomness = 1;
                this.session_transfer = 80;
                this.lap_gain = 300;
              } else if (this.dynamic_track_preset == 4) {
                this.session_start = 95;
                this.randomness = 2;
                this.session_transfer = 90;
                this.lap_gain = 132;
              } else if (this.dynamic_track_preset == 5) {
                this.session_start = 98;
                this.randomness = 2;
                this.session_transfer = 80;
                this.lap_gain = 700;
              } else if (this.dynamic_track_preset == 6) {
                this.session_start = 100;
                this.randomness = 0;
                this.session_transfer = 100;
                this.lap_gain = 1;
              }
            }
          }
        }
      </script>
      <form class="flex flex-wrap" method="POST">
        <div class="w-full lg:w-1/2 mt-6 pl-0 lg:pl-2">
          <p class="text-xl px-6 pb-6 flex items-center">
            <i class="fas fa-list mr-3"></i> Assists
          </p>
          <div class="p-10 leading-loose">
            <div class="">
              <label class="block text-sm text-gray-600" for="abs_allowed">ABS</label>
              <select class="w-full text-gray-700 bg-gray-200 rounded py-3 px-4 pr-8" id="abs_allowed"
                name="abs_allowed">
                <option value="0" {% if data.form['abs_allowed']==0 %} selected {% endif %}>Denied</option>
                <option value="1" {% if data.form['abs_allowed']==1 %} selected {% endif %}>Factory</option>
                <option value="2" {% if data.form['abs_allowed']==2 %} selected {% endif %}>Force</option>
              </select>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="tc_allowed">Traction Control</label>
              <select class="w-full text-gray-700 bg-gray-200 rounded py-3 px-4 pr-8" id="tc_allowed" name="tc_allowed">
                <option value="0" {% if data.form['tc_allowed']==0 %} selected {% endif %}>Denied</option>
                <option value="1" {% if data.form['tc_allowed']==1 %} selected {% endif %}>Factory</option>
                <option value="2" {% if data.form['tc_allowed']==2 %} selected {% endif %}>Force</option>
              </select>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="stability_allowed">Stability Control</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                <input type="checkbox" name="stability_allowed" id="stability_allowed" value="1" {% if
                  data.form['stability_allowed']==1 %} checked {% endif %}
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="stability_allowed"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                <input type='hidden' value='0' name='stability_allowed'>
              </div>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="autoclutch_allowed">Auto Clutch</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                <input type="checkbox" name="autoclutch_allowed" id="autoclutch_allowed" value="1" {% if
                  data.form['autoclutch_allowed']==1 %} checked {% endif %}
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="autoclutch_allowed"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                <input type='hidden' value='0' name='autoclutch_allowed'>
              </div>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="tyre_blankets_allowed">Tyre Blankets</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                <input type="checkbox" name="tyre_blankets_allowed" id="tyre_blankets_allowed" value="1" {% if
                  data.form['tyre_blankets_allowed']==1 %} checked {% endif %}
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="tyre_blankets_allowed"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                <input type='hidden' value='0' name='tyre_blankets_allowed'>
              </div>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="force_virtual_mirror">Force Virtual Mirrors</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                <input type="checkbox" name="force_virtual_mirror" id="force_virtual_mirror" value="1" {% if
                  data.form['force_virtual_mirror']==1 %} checked {% endif %}
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="force_virtual_mirror"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                <input type='hidden' value='0' name='force_virtual_mirror'>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full lg:w-1/2 mt-6 pl-0 lg:pl-2">
          <p class="text-xl px-6 pb-6 flex items-center">
            <i class="fas fa-list mr-3"></i> Realism
          </p>
          <div class="p-10 leading-loose">
            <div class="">
              <label class="block text-sm text-gray-600" for="fuel_rate">Fuel Rate</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="fuel_rate" name="fuel_rate" min="0" max="500"
                type="number" required="" placeholder="Fuel Rate" aria-label="Fuel Rate"
                value="{{ data.form['fuel_rate'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="damage_multiplier">Damage Rate</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="damage_multiplier" min="0" max="400"
                name="damage_multiplier" type="number" required="" placeholder="Damage Rate" aria-label="Damage Rate"
                value="{{ data.form['damage_multiplier'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="tyre_wear_rate">Tyre Wear</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="tyre_wear_rate" min="0" max="500"
                name="tyre_wear_rate" type="number" required="" placeholder="Tyre Wear" aria-label="Tyre Wear"
                value="{{ data.form['tyre_wear_rate'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="allowed_tyres_out">Allowed Tyres Out</label>
              <select class="w-full text-gray-700 bg-gray-200 rounded py-3 px-4 pr-8" id="allowed_tyres_out"
                name="allowed_tyres_out">
                <option value="0" {% if data.form['allowed_tyres_out']==0 %} selected {% endif %}>0</option>
                <option value="1" {% if data.form['allowed_tyres_out']==1 %} selected {% endif %}>1</option>
                <option value="2" {% if data.form['allowed_tyres_out']==2 %} selected {% endif %}>2</option>
                <option value="3" {% if data.form['allowed_tyres_out']==3 %} selected {% endif %}>3</option>
                <option value="4" {% if data.form['allowed_tyres_out']==4 %} selected {% endif %}>4</option>
              </select>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="max_ballast_kg">Max Ballast (KG)</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="max_ballast_kg" min="0" max="300"
                name="max_ballast_kg" type="number" required="" placeholder="Max Balast (KG)"
                aria-label="Max Ballast (KG)" value="{{ data.form['max_ballast_kg'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="start_rule">Jump Start</label>
              <select class="w-full text-gray-700 bg-gray-200 rounded py-3 px-4 pr-8" id="start_rule" name="start_rule">
                <option value="0" {% if data.form['start_rule']==0 %} selected {% endif %}>Car Locked</option>
                <option value="1" {% if data.form['start_rule']==1 %} selected {% endif %}>Teleport To Pit</option>
                <option value="2" {% if data.form['start_rule']==2 %} selected {% endif %}>DriveThrough</option>
              </select>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="race_gas_penality_disabled">Race Gas Penality</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                <input type="checkbox" name="race_gas_penality_disabled" id="race_gas_penality_disabled" value="1" {% if
                  data.form['race_gas_penality_disabled']==1 %} checked {% endif %}
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="race_gas_penality_disabled"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                <input type='hidden' value='0' name='race_gas_penality_disabled'>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full lg:w-1/2 mt-6 pl-0 lg:pl-2"
          x-data="dynamic_track()">
          <p class="text-xl px-6 pb-6 flex items-center">
            <i class="fas fa-list mr-3"></i> Dynamic Track
          </p>
          <div class="p-10 leading-loose">
            <div class="">
              <label class="block text-sm text-gray-600" for="dynamic_track">Enabled</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                <input type="checkbox" name="dynamic_track" id="dynamic_track" value="1" {% if
                  data.form['dynamic_track']==1 %} checked {% endif %} @click="set_open($event.target.checked)"
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="dynamic_track"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                <input type="hidden" value="0" name="dynamic_track" />
              </div>
            </div>

            <div x-show="open">
              <div class="mt-2">
                <label class="block text-sm text-gray-600" for="dynamic_track_preset">Preset</label>
                <select class="w-full text-gray-700 bg-gray-200 rounded py-3 px-4 pr-8" id="dynamic_track_preset"
                  :required="open" name="dynamic_track_preset" x-model="dynamic_track_preset" @change="preset_changed()">
                  <option value="0" {% if data.form['dynamic_track_preset']==0 %} selected {% endif %}>Custom</option>
                  <option value="1" {% if data.form['dynamic_track_preset']==1 %} selected {% endif %}>Dusty</option>
                  <option value="2" {% if data.form['dynamic_track_preset']==2 %} selected {% endif %}>Old</option>
                  <option value="3" {% if data.form['dynamic_track_preset']==3 %} selected {% endif %}>Slow</option>
                  <option value="4" {% if data.form['dynamic_track_preset']==4 %} selected {% endif %}>Green</option>
                  <option value="5" {% if data.form['dynamic_track_preset']==5 %} selected {% endif %}>Fast</option>
                  <option value="6" {% if data.form['dynamic_track_preset']==6 %} selected {% endif %}>Optimum</option>
                </select>
              </div>
              <div class="mt-2">
                <label class="block text-sm text-gray-600" for="session_start">Start Value</label>
                <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="session_start" x-model="session_start" min="80" max="100"
                  name="session_start" type="number" :required="open" :disabled="dynamic_track_preset != 0" placeholder="Start Value" aria-label="Start Value" />
                <input type="hidden" name="session_start" x-model="session_start" />
              </div>
              <div class="mt-2">
                <label class="block text-sm text-gray-600" for="randomness">Randomness</label>
                <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="randomness" name="randomness" min="0" max="10"
                  type="number" :required="open" :disabled="dynamic_track_preset != 0" placeholder="Randomness" aria-label="Randomness" x-model="randomness" />
                <input type="hidden" name="randomness" x-model="randomness" />
              </div>
              <div class="mt-2">
                <label class="block text-sm text-gray-600" for="session_transfer">Transfer Grip</label>
                <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="session_transfer" x-model="session_transfer" min="0" max="100"
                  name="session_transfer" type="number" :required="open" :disabled="dynamic_track_preset != 0" placeholder="Transfer Grip" aria-label="Transfer Grip" />
                <input type="hidden" name="session_transfer" x-model="session_transfer" />
              </div>
              <div class="mt-2">
                <label class="block text-sm text-gray-600" for="lap_gain">Laps to Improve Grip</label>
                <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="lap_gain" name="lap_gain" x-model="lap_gain" min="0" max="1000"
                  type="number" :required="open" :disabled="dynamic_track_preset != 0" placeholder="Laps to Improve Grip" aria-label="Laps to Improve Grip" />
                <input type="hidden" name="lap_gain" x-model="lap_gain" />
              </div>
            </div>


          </div>
        </div>

        <div class="w-full lg:w-1/2 mt-6 pl-0 lg:pl-2">
          <p class="text-xl px-6 pb-6 flex items-center">
            <i class="fas fa-list mr-3"></i> Voting and Banning
          </p>
          <div class="p-10 leading-loose">
            <div class="">
              <label class="block text-sm text-gray-600" for="kick_quorum">Kick Vote Quorum</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="kick_quorum" name="kick_quorum" min="0" max="101"
                type="number" required="" placeholder="Kick Vote Quorum" aria-label="Kick Vote Quorum"
                value="{{ data.form['kick_quorum'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="voting_quorum">Session Vote Quorum</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="voting_quorum" name="voting_quorum" min="0" max="101"
                type="number" required="" placeholder="Session Vote Quorum" aria-label="Session Vote Quorum"
                value="{{ data.form['voting_quorum'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="vote_duration">Vote Duration</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="vote_duration" name="vote_duration" min="10" max="30"
                type="number" required="" placeholder="Vote Duration" aria-label="Vote Duration"
                value="{{ data.form['vote_duration'] }}" />
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="blacklist_mode">Blacklist</label>
              <select class="w-full text-gray-700 bg-gray-200 rounded py-3 px-4 pr-8" id="blacklist_mode"
                name="blacklist_mode">
                <option value="0" {% if data.form['blacklist_mode']==0 %} selected {% endif %}>Kick Player</option>
                <option value="1" {% if data.form['blacklist_mode']==1 %} selected {% endif %}>Kick Until Restart
                </option>
              </select>
            </div>
            <div class="mt-2">
              <label class="block text-sm text-gray-600" for="max_contacts_per_km">Max Collision per KM</label>
              <input class="w-full px-5 py-1 text-gray-700 bg-gray-200 rounded" id="max_contacts_per_km" min="-1" max="128"
                name="max_contacts_per_km" type="number" required="" placeholder="Max Collision per KM"
                aria-label="Max Collision per KM" value="{{ data.form['max_contacts_per_km'] }}" />
            </div>
          </div>
        </div>

        <div class="w-full lg:w-1/2 mt-6 pl-0 lg:pl-2" x-data=" { btnClick : true }">
          <p class="text-xl pb-6 flex items-center">
            <button class="px-4 py-1 text-white font-light tracking-wider bg-gray-900 rounded-l-md" type="submit">
              Save
            </button>
            <button class="px-4 py-1 text-white font-light tracking-wider bg-red-900 rounded-r-md" type="button"
              @click="document.getElementById('frmDelete').submit()">
              Delete
            </button>
          </p>
        </div>
    </div>
    </form>
    <form id="frmDelete" action="{{ url_for('difficulty_delete', id=data['id']) }}" method="POST"></form>
    {% endif %}
  </div>
</div>

{% endblock %}
